load "divisors.m";


p := 5;
F := GF(p);
A<u,v> := AffineSpace(F,2);

// these equations are taken from the maple file

f := -14*u^10*v^2 + 28*u^7*v^5 - 14*u^4*v^8 - 7*u^11 + 44*u^8*v^3 + 521*u^5*v^6 - 54*u^2*v^9 + 169*u^9*v - 68*u^6*v^4 + 2359*u^3*v^7 - 54*v^10 - 1078*u^7*v^2 - 5430*u^4*v^5 + 2835*u*v^8 - 242*u^8 + 3597*u^5*v^3 - 3924*u^2*v^6 + 3503*u^6*v + 20304*u^3*v^4 + 29673*v^7 - 26065*u^4*v^2 - 72306*u*v^5 - 263*u^5 + 51912*u^2*v^3 + 13688*u^3*v + 9504*v^4 - 44928*u*v^2 - 6912*u^2 + 27648*v;
E := [1, -1, 1, 4, 6];
x := -(14*u^9 - 28*u^8*v + 14*u^7*v^2 + 42*u^6*v^3 + 238*u^5*v^4 - 14*u^4*v^5 + 28*u^3*v^6 - 42*u^2*v^7 + 7*u^8 - 51*u^7*v + 227*u^6*v^2 + 19*u^5*v^3 + 295*u^4*v^4 + 2103*u^3*v^5 - 68*u^2*v^6 + 24*u*v^7 - 72*v^8 + 122*u^7 - 253*u^6*v - 58*u^5*v^2 - 2851*u^4*v^3 - 74*u^3*v^4 + 2413*u^2*v^5 + 4170*u*v^6 - 108*v^7 - 24*u^6 - 1164*u^5*v + 815*u^4*v^2 - 3379*u^3*v^3 - 10415*u^2*v^4 + 672*u*v^5 + 4959*v^6 + 521*u^5 + 905*u^4*v + 16739*u^3*v^2 + 1777*u^2*v^3 - 12888*u*v^4 + 21393*v^5 - 1562*u^4 - 5078*u^3*v + 9307*u^2*v^2 - 36978*u*v^3 - 3528*v^4 - 2422*u^3 - 428*u^2*v + 9744*u*v^2 - 2520*v^3 + 2880*u^2 - 1680*u*v + 14688*v^2 + 1728*u - 11520*v + 6912)/(-28*u^7*v^2 + 84*u^5*v^4 - 56*u^4*v^5 + 14*u^8 - 150*u^5*v^3 + 478*u^3*v^5 - 258*u^2*v^6 + 35*u^7 + 47*u^6*v - 1253*u^4*v^3 + 409*u^3*v^4 + 666*u*v^6 - 378*v^7 - 110*u^5*v + 754*u^4*v^2 - 2055*u^2*v^4 + 3501*u*v^5 - 478*u^5 + 6131*u^3*v^2 - 6369*u^2*v^3 + 11070*v^5 - 1203*u^4 + 3023*u^3*v - 20448*u*v^3 - 216*v^4 + 3192*u^2*v - 576*u*v^2 - 1296*u^2 + 6912*v^2 + 3456*v);
y := 3*(879381145363*u^11 - 8289818393598*u^9*v^2 - 19166496824928*u^8*v^3 + 8024536210782*u^6*v^5 + 17199490631865*u^5*v^6 + 358786230180*u^3*v^8 + 1087625047700*u^2*v^9 - 93504047364*v^11 - 3116730237614*u^10 - 16769714738860*u^9*v - 25563404498079*u^7*v^3 - 279910921880049*u^6*v^4 + 121530974132575*u^4*v^6 + 22770944609035*u^3*v^7 + 3690831213832*u*v^9 + 1065883754952*v^10 + 299679228576*u^9 + 87011441722121*u^8*v + 118158203887234*u^7*v^2 - 448653462754644*u^5*v^4 - 1203992953627441*u^4*v^5 + 350872672927154*u^2*v^7 - 11511277801345*u*v^8 - 672874711236*v^9 - 15293050143753*u^8 - 22230083804656*u^7*v - 146627653784206*u^6*v^2 + 1645977419016902*u^5*v^3 + 144844654526026*u^4*v^4 - 3154627146329379*u^3*v^5 - 1461844488732716*u^2*v^6 + 496620658337727*v^8 - 129843415760317*u^7 - 209578058531930*u^6*v + 240374657901469*u^5*v^2 + 2763346025768762*u^4*v^3 + 3544395101157019*u^3*v^4 + 1454975924144743*u^2*v^5 - 5362314346087972*u*v^6 - 347446090525989*v^7 + 10066906443048*u^6 + 454515607137228*u^5*v - 1976616521666315*u^4*v^2 - 1019707599844297*u^3*v^3 + 10011694014002464*u^2*v^4 - 1304919176216288*u*v^5 + 2881118451424122*v^6 - 381602471017562*u^5 - 555752005042689*u^4*v - 8819952038924131*u^3*v^2 - 10495018128049399*u^2*v^3 - 7049585975077191*u*v^4 - 15410259808786731*v^5 + 998703269051131*u^4 + 9452752358611768*u^3*v + 4620356755780402*u^2*v^2 + 9919825255152610*u*v^3 + 26853021336140760*v^4 + 644536438128856*u^3 + 110005269958388*u^2*v - 15071177113810960*u*v^2 + 4776461362711584*v^3 - 3102372535183008*u^2 - 7106244593683872*u*v + 11901472488448032*v^2 - 4219306331647680*u + 2674782714407424*v + 2529401101613568)/(7*(391096234284*u^9*v^2 + 2352734113562*u^8*v^3 - 5591671643362*u^7*v^4 + 2307014916108*u^6*v^5 + 514055330110*u^5*v^6 + 307283191390*u^4*v^7 - 280512142092*u^3*v^8 + 195548117142*u^10 + 2683877591689*u^9*v - 1612679811631*u^8*v^2 + 11151186949478*u^7*v^3 - 8958077205661*u^6*v^4 - 45504392888271*u^5*v^5 + 25692744430910*u^4*v^6 + 2011065013830*u^3*v^7 + 2026771593066*u^2*v^8 - 801463263120*u*v^9 - 915932529883*u^9 + 2459373670048*u^8*v - 41931384793040*u^7*v^2 + 75376724650195*u^6*v^3 - 10726864202720*u^5*v^4 - 132176120892967*u^4*v^5 - 128944225445081*u^3*v^6 + 88326122571438*u^2*v^7 - 544761483642*u*v^8 + 3589624956150*v^9 - 7354684915574*u^8 + 6107268897736*u^7*v - 108473123042925*u^6*v^2 + 263845997554565*u^5*v^3 + 304318361706160*u^4*v^4 - 400005755365657*u^3*v^5 - 110086605837183*u^2*v^6 - 160219589658903*u*v^7 + 76241451784986*v^8 - 1771998906943*u^7 + 110275016662487*u^6*v - 351509831021723*u^5*v^2 + 401821588418218*u^4*v^3 + 655594013697019*u^3*v^4 - 247539413705244*u^2*v^5 - 642094534374939*u*v^6 + 107052613676496*v^7 + 38003865684803*u^6 + 225321311818947*u^5*v - 1381333420968470*u^4*v^2 + 41375977526289*u^3*v^3 + 1594318992711054*u^2*v^4 - 2187893274445296*u*v^5 - 1662578815633875*v^6 + 90571878429974*u^5 + 295469847248443*u^4*v - 2195969158400732*u^3*v^2 + 3226390804093200*u^2*v^3 + 3014801227748592*u*v^4 - 2186345311623234*v^5 - 3389526770535*u^4 + 220662091335712*u^3*v - 1210534392352668*u^2*v^2 + 3729991160419488*u*v^3 + 988710358546368*v^4 - 256094673697656*u^3 + 832822760244456*u^2*v - 2330957503823616*u*v^2 - 1223647865719488*v^3 + 956626879568832*u*v - 2689486446672000*v^2));



X0 := Curve(A,f);
X := ProjectiveClosure(X0);
assert Genus(X) eq 11;
assert IsReduced(X);
assert IsIrreducible(X);

E := ChangeRing(EllipticCurve(E),F);
phi :=  map< X -> E | [x,y,1]>;
assert Degree(phi) eq 8;
zero := E ! 0;
P := [P : P in Points(E) | Order(P) eq 4][1];

D0 := Pullback(phi,Place(P))-Pullback(phi,Place(zero));
// D0 is the image of an element P in E(F_5) of order 4 under E -> J_0


divs := Divisors_of_Degree(5,X);
print "Nr. of divisors over F_5 to check:", #divs;

todo := [];
for D in Setseq(divs) do
  dim := Dimension(RiemannRochSpace(D[1]+D0));
  if dim gt 0 then
    Append(~todo, D[1]);
  end if;
end for;

assert #todo eq 0;

print "Nr. of divisors D such that D+D0 in W_5^0:", #todo;
print "computations for X0(117) finished";

exit;

